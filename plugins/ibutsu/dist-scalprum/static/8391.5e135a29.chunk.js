"use strict";(self.webpackChunkinternal_backstage_plugin_ibutsu=self.webpackChunkinternal_backstage_plugin_ibutsu||[]).push([[8391],{8391:(e,t,n)=>{n.r(t),n.d(t,{IbutsuComponent:()=>E});var r=n(1085),s=n(5478),i=n.n(s),o=n(7625),l=n(9719),a=n(4801),c=n(2501),u=n(2776),d=n(9203),h=n(1009),x=n(3677),j=n(4947),m=n(8467),p=n(2899),g=n(985),A=n(4321),b=n(7976),f=n(4344),k=n(8305),v=n(9490),y=n(6400),C=n(9895);function E(){var e,t;const[n,E]=i().useState([]),[S,w]=i().useState([]),[I,$]=i().useState(0),[P,F]=i().useState([]),[N,T]=i().useState(!1),[_,R]=i().useState(!1),[D,G]=i().useState(!0),L=(0,v.useApi)(v.configApiRef),{entity:U}=(0,y.tN)();console.log(null==U||null===(t=U.metadata)||void 0===t||null===(e=t.annotations)||void 0===e?void 0:e["ibutsu/component-name"]);const z=(0,b.makeStyles)((e=>(0,b.createStyles)({root:{"& > *":{margin:e.spacing(1)}}}))),O=(0,b.makeStyles)((e=>(0,b.createStyles)({root:{display:"flex",alignItems:"center",justifyContent:"center","& > * + *":{marginLeft:e.spacing(2)}}}))),q=z(),B=O(),H=()=>n.length/5,J=()=>{I>=H()||$(I+1)},K=()=>{0!==I&&$(I-1)},M=()=>{var e,t,n,r,s,i;return(null==U||null===(t=U.metadata)||void 0===t||null===(e=t.annotations)||void 0===e?void 0:e["ibutsu/component-name"])?null==U||null===(i=U.metadata)||void 0===i||null===(s=i.annotations)||void 0===s?void 0:s["ibutsu/component-name"]:null==U||null===(r=U.metadata)||void 0===r?void 0:r.name.substring(0,null==U||null===(n=U.metadata)||void 0===n?void 0:n.name.indexOf("-"))},Q=()=>`${L.getString("backend.baseUrl")}/api/proxy/ibutsu/api`,V=()=>(0,r.jsx)(o.A,{children:(0,r.jsxs)(l.A,{children:[(0,r.jsx)(a.A,{align:"center",children:(0,r.jsx)(c.A,{variant:"button",children:"Created"})}),(0,r.jsx)(a.A,{align:"center",children:(0,r.jsx)(c.A,{variant:"button",children:"Run ID"})}),(0,r.jsx)(a.A,{align:"center",children:(0,r.jsx)(c.A,{variant:"button",children:"Duration"})}),(0,r.jsx)(a.A,{align:"center",children:(0,r.jsx)(c.A,{variant:"button",children:"Environment"})}),(0,r.jsx)(a.A,{align:"center",children:(0,r.jsx)(c.A,{variant:"button",children:"Results"})})]})}),W=[{key:"collected",title:"Collected",color:"#0066CC"},{key:"tests",title:"Total",color:"#0066CC"},{key:"passes",title:"Passed",color:"#63993d"},{key:"errors",title:"Errors",color:"#EE0000"},{key:"failures",title:"Failures",color:"#EE0000"},{key:"not_run",title:"Not Run",color:"#0066CC"},{key:"skips",title:"Skipped",color:"#0066CC"},{key:"xfailures",title:"xFailures",color:"#EE0000"},{key:"xpasses",title:"xPasses",color:"#63993d"}],X=({result:e})=>(0,r.jsx)(k.A,{direction:"row",spacing:1,children:W.map((t=>e.summary[t.key]>0&&(0,r.jsx)(u.Ay,{title:t.title,children:(0,r.jsx)(f.A,{style:{backgroundColor:t.color,color:"#FFFFFF"},children:e.summary[t.key]})})))}),Y=({result:e})=>{return(0,r.jsxs)(l.A,{children:[(0,r.jsx)(a.A,{align:"center",children:(t=e.created,`${t.substring(0,10)}, ${t.substring(11,19)}`)}),(0,r.jsx)(a.A,{align:"center",children:(0,r.jsx)(d.A,{href:`${P}/runs/${e.id}`,children:e.id})}),(0,r.jsxs)(a.A,{align:"center",children:[e.duration.toFixed(1),"s"]}),(0,r.jsx)(a.A,{align:"center",children:e.env}),(0,r.jsx)(a.A,{align:"center",children:(0,r.jsx)(X,{result:e})})]});var t},Z=()=>(0,r.jsxs)(h.A,{"aria-label":"simple table",children:[(0,r.jsx)(V,{}),(0,r.jsx)(x.A,{children:S.map((e=>(0,r.jsx)(Y,{result:e})))})]}),ee=()=>(0,r.jsxs)("div",{className:q.root,children:[(0,r.jsx)(j.A,{variant:"contained",color:"primary",onClick:K,disabled:!(I>0),children:"Previous"}),(0,r.jsx)(j.A,{variant:"contained",color:"primary",onClick:J,disabled:!(I<H()),children:"Next"})]});return(0,s.useEffect)((()=>{(async()=>{const e=`${Q()}/health/info`;fetch(e,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{if(!e.ok)throw new Error(`Network response was not ok ${e.statusText}`);return e.json()})).then((e=>{F(e.frontend),console.log(P)})).catch((e=>{T(!0),console.error("error fetching health data from Ibutsu API:",e)}))})(),(async()=>{const e={filter:`component=${M()}`,page:1,pageSize:50},t=new URLSearchParams(e).toString(),n=`${Q()}/run?${t}`;fetch(n,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{if(!e.ok)throw new Error(`Network response was not ok ${e.statusText}`);return e.json()})).then((e=>{const t=e.runs;if(0===t.length)throw new Error("No test runs data was returned from the Ibutsu API");E(t.filter((e=>e.component===M()))),console.log(e)})).catch((e=>{R(!0),console.error("Error fetching test run data from Ibutsu API:",e)})).finally((()=>{G(!1)}))})()}),[]),(0,s.useEffect)((()=>{const e=5*I;w(n.slice(e,e+5))}),[I,n]),N?(0,r.jsx)(C.n,{children:(0,r.jsx)(c.A,{children:"Error retrieving Ibutsu health data from Ibutsu API"})}):_?(0,r.jsx)(C.n,{children:(0,r.jsx)(c.A,{children:"Error retrieving Ibutsu test runs data from Ibutsu API"})}):D?(0,r.jsx)("div",{className:B.root,children:(0,r.jsx)(m.A,{})}):(0,r.jsxs)(C.n,{title:"Test Results",noPadding:!0,children:[(0,r.jsx)(p.A,{container:!0,spacing:3,direction:"column",children:(0,r.jsx)(p.A,{item:!0,children:(0,r.jsx)(g.A,{component:A.A,children:(0,r.jsx)(Z,{})})})}),(0,r.jsx)(ee,{})]})}}}]);
//# sourceMappingURL=8391.5e135a29.chunk.js.map